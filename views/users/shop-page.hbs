<style>
    /* Custom CSS */
    .header-area {
      margin-bottom: 20px; /* Adjust the margin as needed */
    }
    .fixed-height-image {
  height: 325px; /* Adjust the height as needed */
  object-fit: cover;
}

  </style>
</head>
<body>
  <!-- ***** Preloader Start ***** -->
  <div id="preloader">
    <div class="jumper">
      <div></div>
      <div></div>
      <div></div>
    </div>
  </div>
  <!-- ***** Preloader End ***** -->

  <!-- ***** Header Area Start ***** -->
  <header class="header-area header-sticky">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <nav class="main-nav">
            <!-- ***** Logo Start ***** -->
            <a href="index.html" class="logo">
              <img class="logo-img" src="/assets/images/dhub-main.png" />
            </a>
            <!-- ***** Logo End ***** -->
            <!-- ***** Menu Start ***** -->
            <ul class="nav">
              <li class="scroll-to-section">
                <a href="/home" class="active">Home</a>
              </li>
              <li class="scroll-to-section"><a href="/shop-page">SHOP</a></li>
              <li class="scroll-to-section"><a href="/user-profile">PROFILE</a></li>
              <li class="scroll-to-section"><a href="/load-cart">CART</a></li>
              <li>
                <a href="/logout">
                  <button type="button" class="btn btn-dark" style="color: white">LOGOUT</button>
                </a>
              </li>
            </ul>
            <!-- ***** Menu End ***** -->
          </nav>
        </div>
      </div>
    </div>
  </header>
  <!-- ***** Header Area End ***** -->

 <div class="container mt-5 pt-5">
  <h1 class="mb-2 pb-2 pt-2">Shop</h1>

  <!-- Search Bar -->
  <form id="products-list-form">

  
  <div style="display: inline-flex; gap: 5px;">

 
  <div class="row mb-4">
    <div class="col-md-6">
      <input placeholder="Search" name="searchKeyword" id="searchKeyword" type="search" class="input" style="width: 150px;">
    </div>
  </div>

  <!-- Filter and Sort Options -->
  <div class="row mb-4 g-3" style="display: flex; " >
   <div class="col-md-4">
   <select id="category" class="form-control" style="width: 250px;"  name="category">
    <option value="">All Categories</option>
    {{#each category}}
      <option value="{{this.category}}">{{this.category}}</option>
    {{/each}}
   </select>
   </div>

  
    <div class="col-md-4" style="padding-left: 38px;">
      <select id="sortBy" name="sortBy" class="form-control" style="width: 250px;">
        <option value="product_name">Name</option>
        <option value="product_price">Price</option>
      </select>
    </div>

    <div class="col-md-2 col-sm-6 d-flex justify-content-center" style="margin-left: 30px;">
        <button type="submit" class="btn  btn-dark">Find</button>
      </div>
  </div>
 </div>
 </form>
  <!-- Products Grid -->
  <div class="row" id="productsGrid">
    {{#if listedItems}}
 <div class="tab-pane fade show active" id="tab-one" role="tabpanel" aria-labelledby="tab-one">
                <div class="row product-grid-4" id="search-results">{{{listedItems}}}</div>
        </div>
    {{/if}}
  </div>
</div>



  <footer>
    <div class="container">
      <div class="row">
        <div class="col-lg-3">
          <div class="first-item">
            <div class="logo">
              <h4>D-HUD ONLINE</h4>
              <img src="" alt="" />
            </div>
            <ul>
              <li><a href="#">16501 Collins Ave, FL 33160, Kochi</a></li>
              <li><a href="#">d-hub@company.com</a></li>
              <li><a href="#">010-020-0340</a></li>
            </ul>
          </div>
        </div>
        <div class="col-lg-3">
          <h4>Shopping &amp; Categories</h4>
          <ul>
            <li><a href="#">Online Shopping</a></li>
            <li><a href="#"></a></li>
          </ul>
        </div>
        <div class="col-lg-3">
          <h4>Useful Links</h4>
          <ul>
            <li><a href="#">Homepage</a></li>
            <li><a href="#">About Us</a></li>
            <li><a href="#">Help</a></li>
            <li><a href="#">Contact Us</a></li>
          </ul>
        </div>
        <div class="col-lg-3">
          <h4>Help &amp; Information</h4>
          <ul>
            <li><a href="#">Help</a></li>
            <li><a href="#">FAQ's</a></li>
            <li><a href="#">Shipping</a></li>
            <li><a href="#">Tracking ID</a></li>
          </ul>
        </div>
        <div class="col-lg-12">
          <div class="under-footer">
            <p>
              Copyright Â© 2023 D-HUB Co., Ltd. All Rights Reserved.
              <br />
            </p>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script>

let { resultsHTML } = require("../../helpers/userHelpers");
$("#products-list-form").submit((e) => {
  e.preventDefault();
  let searchKeyword = $('#searchItem').val().trim();
  let category = $("#categorySort select[name='category']").val();
  let sortBy = $("#sortBy").val();

  let url = "/shop-page";

  let hasQueryParams = false;

  if (searchKeyword !== "") {
    url += "?search=" + encodeURIComponent(searchKeyword);
    hasQueryParams = true;
  }

  if (category !== "") {
    url += (hasQueryParams ? "&" : "?") + "category=" + encodeURIComponent(category);
    hasQueryParams = true;
  }

  if (sortBy !== "") {
    url += (hasQueryParams ? "&" : "?") + "sort=" + encodeURIComponent(sortBy);
  }

  console.log(url);

  // Send AJAX request
  $.ajax({
    url: url,
    method: "get",
    success: async function (response) {
      let resultsHTML = await generateResultsHTML(response);
      $('#searchResults').html(resultsHTML);
    },
    error: function (xhr, status, error) {
      console.error(error);
    }
  });
});

</script>
